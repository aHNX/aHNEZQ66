var isNode="undefined"!=typeof module&&module.exports;if(isNode)var SanityTest=require(__dirname+"/../../test/sanitytest");var Urlencoded={detect:function(a){return -1===a.indexOf(" ")&&(-1!==a.indexOf("%2")||a.replace(/[^%]+/g,"").length>3)},unpack:function(a){return Urlencoded.detect(a)?-1!==a.indexOf("%2B")|| -1!==a.indexOf("%2b")?unescape(a.replace(/\+/g,"%20")):unescape(a):a},run_tests:function(b){var a=b||new SanityTest;return a.test_function(Urlencoded.detect,"Urlencoded.detect"),a.expect("",!1),a.expect("var a = b",!1),a.expect("var%20a+=+b",!0),a.expect("var%20a=b",!0),a.expect("var%20%21%22",!0),a.expect("javascript:(function(){var%20whatever={init:function(){alert(%22a%22+%22b%22)}};whatever.init()})();",!0),a.test_function(Urlencoded.unpack,"Urlencoded.unpack"),a.expect("javascript:(function(){var%20whatever={init:function(){alert(%22a%22+%22b%22)}};whatever.init()})();",'javascript:(function(){var whatever={init:function(){alert("a"+"b")}};whatever.init()})();'),a.expect("",""),a.expect("abcd","abcd"),a.expect("var a = b","var a = b"),a.expect("var%20a=b","var a=b"),a.expect("var%20a=b+1","var a=b+1"),a.expect("var%20a=b%2b1","var a=b+1"),a}};isNode&&(module.exports=Urlencoded)
